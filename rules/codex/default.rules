prefix_rule(pattern=["powershell", "-Command", "Get-CimInstance"], decision="allow")
prefix_rule(pattern=["wsl", "-l", "-v"], decision="allow")
prefix_rule(pattern=["wsl", "-d", "Ubuntu-24.04", "--", "bash", "-lc"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'echo user=$(whoami); echo HOME=$HOME; ls -la /home; ls -la /home/jacks'"], decision="allow")
prefix_rule(pattern=["wsl", "-d", "Ubuntu-24.04", "--", "bash", "-lc", "set -euo pipefail"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; mkdir -p /home/jacks/jacks_happy_bots; rsync -a --delete --exclude .git --exclude .venv --exclude .pytest_cache --exclude __pycache__ --exclude node_modules /mnt/c/Users/monke/jacks_happy_bots/ /home/jacks/jacks_happy_bots/; install -m 600 /mnt/c/Users/monke/jacks_happy_bots/.env /home/jacks/jacks_happy_bots/.env; echo synced'"], decision="allow")
prefix_rule(pattern=["wsl", "-d", "Ubuntu-24.04", "--", "bash", "-lc", "cd /home/jacks/jacks_happy_bots"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; ls -la /home/jacks/jacks_happy_bots/.env; stat -c \"%U:%G %a %n\" /home/jacks/jacks_happy_bots/.env'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; python sdk/telegram/poller.py test --json'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; command -v openclaw || true; python scripts/saga-skills/service_manager.py start openclaw-gateway --json; python scripts/saga-skills/service_manager.py start telegram-poller --json; python scripts/saga-skills/service_manager.py status --json'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; ps -ef | grep -E \"poller.py run|openclaw\" | grep -v grep'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cd /home/jacks/jacks_happy_bots; tail -n 20 data/skill_events.jsonl'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'pgrep -af \"poller.py run|openclaw\" || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'pgrep -af \"poller.py run\"; pgrep -af \"openclaw\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; whoami; sudo -n true && echo sudo_nopass_ok || echo sudo_need_password'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; echo \"--- /etc/wsl.conf (before) ---\"; if [ -f /etc/wsl.conf ]; then cat /etc/wsl.conf; else echo \"(missing)\"; fi'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; echo BEFORE; if [ -f /etc/wsl.conf ]; then cat /etc/wsl.conf; else echo MISSING; fi'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; if grep -q \"^\\[boot\\]\" /etc/wsl.conf 2>/dev/null; then sudo sed -i \"/^\\[boot\\]/,/^\\[/ s/^systemd=.*/systemd=true/\" /etc/wsl.conf; if ! awk \"/^\\[boot\\]/{f=1;next}/^\\[/{f=0}f && /^systemd=/{print;found=1}END{exit found?0:1}\" /etc/wsl.conf; then sudo sed -i \"/^\\[boot\\]/a systemd=true\" /etc/wsl.conf; fi; else printf \"\\n[boot]\\nsystemd=true\\n\" | sudo tee -a /etc/wsl.conf >/dev/null; fi; echo AFTER; cat /etc/wsl.conf'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; if ! grep -q \"^systemd=true\" /etc/wsl.conf 2>/dev/null; then printf \"\\n[boot]\\nsystemd=true\\n\" | sudo tee -a /etc/wsl.conf >/dev/null; fi; echo AFTER; cat /etc/wsl.conf'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; printf \"%s\\n\" \"[user]\" \"default=jacks\" \"\" \"[interop]\" \"appendWindowsPath=false\" \"\" \"[boot]\" \"systemd=true\" | sudo tee /etc/wsl.conf >/dev/null; echo FIXED; cat /etc/wsl.conf'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; sudo sh -c \"echo [user] > /etc/wsl.conf; echo default=jacks >> /etc/wsl.conf; echo >> /etc/wsl.conf; echo [interop] >> /etc/wsl.conf; echo appendWindowsPath=false >> /etc/wsl.conf; echo >> /etc/wsl.conf; echo [boot] >> /etc/wsl.conf; echo systemd=true >> /etc/wsl.conf\"; echo FIXED2; cat /etc/wsl.conf'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; echo [user] | sudo tee /etc/wsl.conf >/dev/null; echo default=jacks | sudo tee -a /etc/wsl.conf >/dev/null; echo | sudo tee -a /etc/wsl.conf >/dev/null; echo [interop] | sudo tee -a /etc/wsl.conf >/dev/null; echo appendWindowsPath=false | sudo tee -a /etc/wsl.conf >/dev/null; echo | sudo tee -a /etc/wsl.conf >/dev/null; echo [boot] | sudo tee -a /etc/wsl.conf >/dev/null; echo systemd=true | sudo tee -a /etc/wsl.conf >/dev/null; echo FIXED3; cat /etc/wsl.conf'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; python scripts/saga-skills/service_manager.py status --json; systemctl --user is-enabled telegram-poller.service; systemctl --user is-active telegram-poller.service'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cd /home/jacks/jacks_happy_bots; command -v openclaw || true; ls -la ~/.openclaw || true; ls -la ~/.openclaw/openclaw.json || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; ls -ld /home/jacks/.openclaw; readlink -f /home/jacks/.openclaw; ls -la /home/jacks/.openclaw | sed -n \"1,40p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; command -v node || true; ls -la /home/jacks/openclaw/dist/index.js || true; ls -la /home/jacks/openclaw || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; if [ -f /home/jacks/.config/systemd/user/openclaw-gateway.service ]; then echo EXISTING; sed -n \"1,120p\" /home/jacks/.config/systemd/user/openclaw-gateway.service; else echo MISSING; fi; systemctl --user status openclaw-gateway.service --no-pager -l || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; pip show openclaw || true; npm ls -g --depth=0 2>/dev/null | grep -i openclaw || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; npm view openclaw version'"], decision="allow")
prefix_rule(pattern=["wsl", "-d", "Ubuntu-24.04", "--", "bash", "-lc", "set -euo pipefail; sudo chown -R jacks:jacks /home/jacks/.npm"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; sudo npm install -g openclaw; command -v openclaw; openclaw --help | sed -n \"1,25p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user restart telegram-poller.service; sleep 2; systemctl --user is-active openclaw-gateway.service; systemctl --user is-active telegram-poller.service; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; python scripts/saga-skills/service_manager.py status --json; tail -n 40 data/skill_events.jsonl | grep -E \"conflict_detected|poller_start|poller_stop|instance_lock_denied\" || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user restart telegram-poller.service; sleep 2; systemctl --user is-active openclaw-gateway.service; systemctl --user is-active telegram-poller.service'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; python scripts/saga-skills/service_manager.py status --json'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- python3 -c \"from pathlib import Path; p=Path('/home/jacks/jacks_happy_bots/data/skill_events.jsonl'); lines=p.read_text(encoding='utf-8',errors='ignore').splitlines()[-120:] if p.exists() else []; keys=('conflict_detected','poller_start','poller_stop','instance_lock_denied'); [print(ln) for ln in lines if any(k in ln for k in keys)]\""], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cp /mnt/c/Users/monke/jacks_happy_bots/scripts/saga-skills/service_manager.py /home/jacks/jacks_happy_bots/scripts/saga-skills/service_manager.py; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; python scripts/saga-skills/service_manager.py status --json; systemctl --user is-enabled openclaw-gateway.service; systemctl --user is-active openclaw-gateway.service; systemctl --user is-enabled telegram-poller.service; systemctl --user is-active telegram-poller.service'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; sleep 3; systemctl --user status openclaw-gateway.service --no-pager -l | sed -n \"1,24p\"; echo ---; systemctl --user status telegram-poller.service --no-pager -l | sed -n \"1,24p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; journalctl --user -u openclaw-gateway.service -n 80 --no-pager'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; sed -i \"s#ExecStart=.*#ExecStart=/usr/bin/openclaw gateway --port 18789 --allow-unconfigured#\" /home/jacks/.config/systemd/user/openclaw-gateway.service; systemctl --user daemon-reload; systemctl --user restart openclaw-gateway.service; sleep 2; systemctl --user status openclaw-gateway.service --no-pager -l | sed -n \"1,22p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; echo \"[Unit]\" > /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"Description=OpenClaw Gateway (Jacks Happy Bots)\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"After=network-online.target\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"Wants=network-online.target\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"[Service]\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"Type=simple\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"WorkingDirectory=/home/jacks/jacks_happy_bots\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"ExecStart=/usr/bin/openclaw gateway --port 18789 --allow-unconfigured\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"Restart=always\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"RestartSec=5\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"[Install]\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; echo \"WantedBy=default.target\" >> /home/jacks/.config/systemd/user/openclaw-gateway.service; systemctl --user daemon-reload; systemctl --user restart openclaw-gateway.service; sleep 2; systemctl --user is-active openclaw-gateway.service; systemctl --user status openclaw-gateway.service --no-pager -l | sed -n \"1,22p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cp /mnt/c/Users/monke/jacks_happy_bots/systemd/openclaw-gateway.service /home/jacks/.config/systemd/user/openclaw-gateway.service; systemctl --user daemon-reload; systemctl --user restart openclaw-gateway.service; sleep 2; systemctl --user is-active openclaw-gateway.service; systemctl --user status openclaw-gateway.service --no-pager -l | sed -n \"1,22p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user restart telegram-poller.service; sleep 2; systemctl --user is-active telegram-poller.service; systemctl --user status telegram-poller.service --no-pager -l | sed -n \"1,18p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; pgrep -af openclaw'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user status openclaw-gateway.service --no-pager -l | sed -n \"1,26p\"; journalctl --user -u openclaw-gateway.service -n 30 --no-pager'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; grep -n \"^OPENCLAW_GATEWAY_TOKEN=\" /home/jacks/jacks_happy_bots/.env || true; grep -n \"^OPENCLAW_\" /home/jacks/jacks_happy_bots/.env | sed -n \"1,20p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cp /mnt/c/Users/monke/jacks_happy_bots/systemd/openclaw-gateway.service /home/jacks/.config/systemd/user/openclaw-gateway.service; systemctl --user daemon-reload; systemctl --user restart openclaw-gateway.service; sleep 3; systemctl --user is-active openclaw-gateway.service; systemctl --user status openclaw-gateway.service --no-pager -l | sed -n \"1,22p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user restart telegram-poller.service; sleep 3; systemctl --user is-active telegram-poller.service; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; python scripts/saga-skills/service_manager.py status --json'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- python3 -c \"from pathlib import Path; p=Path('/home/jacks/jacks_happy_bots/data/skill_events.jsonl'); lines=p.read_text(encoding='utf-8',errors='ignore').splitlines()[-40:] if p.exists() else []; c=[ln for ln in lines if 'conflict_detected' in ln]; print('recent_conflicts='+str(len(c))); [print(x) for x in c]\""], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user restart openclaw-gateway.service telegram-poller.service; sleep 3; echo \"gateway=$(systemctl --user is-active openclaw-gateway.service)\"; echo \"poller=$(systemctl --user is-active telegram-poller.service)\"; cd /home/jacks/jacks_happy_bots; source .venv/bin/activate; python scripts/saga-skills/service_manager.py status --json'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; journalctl --user -u telegram-poller.service -n 120 --no-pager'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user status telegram-poller.service --no-pager -l | sed -n \"1,40p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; TOKEN=$(grep -m1 \"^TELEGRAM_BOT_TOKEN=\" /home/jacks/jacks_happy_bots/.env | cut -d= -f2-); curl -s \"https://api.telegram.org/bot${TOKEN}/getWebhookInfo\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; TOKEN=$(grep -m1 \"^TELEGRAM_BOT_TOKEN=\" /home/jacks/jacks_happy_bots/.env | cut -d= -f2- | tr -d \"\\r\"); echo \"token_len=${#TOKEN}\"; echo \"getMe:\"; curl -s \"https://api.telegram.org/bot${TOKEN}/getMe\"; echo; echo \"getWebhookInfo:\"; curl -s \"https://api.telegram.org/bot${TOKEN}/getWebhookInfo\"; echo'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; sed -n \"1,220p\" /home/jacks/jacks_happy_bots/sdk/config.py'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; sed -n \"1,120p\" /home/jacks/jacks_happy_bots/.env'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$win='C:\\Users\\monke\\jacks_happy_bots\\.env'; $winHash=(Get-FileHash $win -Algorithm SHA256).Hash; $wslHash=(wsl -d Ubuntu-24.04 -- bash -lc \"sha256sum /home/jacks/jacks_happy_bots/.env | awk '{print \\$1}'\" ); \"WIN=$winHash\"; \"WSL=$wslHash\""], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "$win='C:\\Users\\monke\\jacks_happy_bots\\.env'; $winHash=(Get-FileHash $win -Algorithm SHA256).Hash; $wslOut=(wsl -d Ubuntu-24.04 -- bash -lc \"sha256sum /home/jacks/jacks_happy_bots/.env\"); \"WIN=$winHash\"; \"WSL_RAW=$wslOut\""], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; tail -n 60 /home/jacks/jacks_happy_bots/data/chat_history.jsonl 2>/dev/null || echo no_chat_history; journalctl --user -u telegram-poller.service -n 120 --no-pager | grep -E \"\\[poller\\] Command:|\\[poller\\] Chat:|Sent reply ok=|Chat reply ok=\" || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'tail -n 80 /home/jacks/jacks_happy_bots/data/chat_history.jsonl 2>/dev/null || echo no_chat_history'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'journalctl --user -u telegram-poller.service -n 160 --no-pager'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'systemctl --user status telegram-poller.service --no-pager -l'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user stop telegram-poller.service; python3 /mnt/c/Users/monke/jacks_happy_bots/scripts/debug_get_updates.py; systemctl --user start telegram-poller.service; systemctl --user is-active telegram-poller.service'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'PYTHONPATH=/home/jacks/jacks_happy_bots python3 /mnt/c/Users/monke/jacks_happy_bots/scripts/debug_send_start.py'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cp /mnt/c/Users/monke/jacks_happy_bots/sdk/telegram/poller.py /home/jacks/jacks_happy_bots/sdk/telegram/poller.py; systemctl --user restart telegram-poller.service; sleep 2; systemctl --user is-active telegram-poller.service'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; pgrep -af \"poller.py run\" || true; pgrep -af \"openclaw gateway\" || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cp /mnt/c/Users/monke/jacks_happy_bots/sdk/telegram/poller.py /home/jacks/jacks_happy_bots/sdk/telegram/poller.py; systemctl --user restart telegram-poller.service; sleep 2; systemctl --user is-active telegram-poller.service; journalctl --user -u telegram-poller.service -n 20 --no-pager'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "Get-CimInstance Win32_Process | Where-Object { $_.CommandLine -match 'poller\\.py|telegram|getUpdates|Jacks_happy_bot|openclaw' } | Select-Object ProcessId,Name,CommandLine | Format-List"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'ps -ef | grep -Ei \"poller.py|openclaw|telegram|getupdates\" | grep -v grep'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'systemctl --user status openclaw-gateway.service --no-pager -l | sed -n \"1,40p\"; echo ---; journalctl --user -u openclaw-gateway.service -n 120 --no-pager'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; cp /mnt/c/Users/monke/jacks_happy_bots/sdk/telegram/poller.py /home/jacks/jacks_happy_bots/sdk/telegram/poller.py; systemctl --user restart telegram-poller.service; sleep 2; systemctl --user is-active telegram-poller.service; systemctl --user status telegram-poller.service --no-pager -l | sed -n \"1,20p\"'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user cat telegram-poller.service; echo ---; systemctl --user cat openclaw-gateway.service'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; rm -f /home/jacks/jacks_happy_bots/scripts/debug_get_updates.py /home/jacks/jacks_happy_bots/scripts/debug_send_start.py; ls -la /home/jacks/jacks_happy_bots/scripts | grep debug_ || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; systemctl --user is-active telegram-poller.service; systemctl --user is-active openclaw-gateway.service'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; rg -n \"getUpdates|debug_get_updates|debug_send_start\" -S /home/jacks/jacks_happy_bots/scripts /home/jacks/jacks_happy_bots/sdk'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; grep -RIn \"getUpdates\\|debug_get_updates\\|debug_send_start\" /home/jacks/jacks_happy_bots/scripts /home/jacks/jacks_happy_bots/sdk || true'"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'set -euo pipefail; grep -RIn \"getUpdates\" /home/jacks/jacks_happy_bots/scripts /home/jacks/jacks_happy_bots/sdk || true; grep -RIn \"debug_get_updates\" /home/jacks/jacks_happy_bots/scripts /home/jacks/jacks_happy_bots/sdk || true; grep -RIn \"debug_send_start\" /home/jacks/jacks_happy_bots/scripts /home/jacks/jacks_happy_bots/sdk || true'"], decision="allow")
prefix_rule(pattern=["wsl", "-d", "Ubuntu-24.04", "--", "python3"], decision="allow")
prefix_rule(pattern=["git", "-C", "C:\\Users\\monke\\jacks_happy_bots", "push", "origin", "main"], decision="allow")
prefix_rule(pattern=["C:\\windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'systemctl --user"], decision="allow")
prefix_rule(pattern=["powershell", "-Command", "Get-ChildItem"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "$skill=(Get-Content config/skill-registry.json -Raw | ConvertFrom-Json); $sched=(Get-Content config/schedule-config.json -Raw | ConvertFrom-Json); $cmd=(Get-Content config/telegram-commands.json -Raw | ConvertFrom-Json); \"skills=\" + ($skill.skills.PSObject.Properties.Name.Count); \"schedules=\" + ($sched.schedules.Count); \"commands=\" + ($cmd.commands.PSObject.Properties.Name.Count); \"agents=\" + (($skill.skills.PSObject.Properties.Value | Group-Object agent | ForEach-Object { $_.Name+\":\"+$_.Count }) -join \", \")"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "if (Get-Command rg -ErrorAction SilentlyContinue) { rg -n \"execute_routed|build_cortex_agent|dispatch_command|process_update|run_pipeline|run_skill|create_.*mcp_server\" sdk scripts tests } else { Write-Output 'rg not found' }"], decision="allow")
prefix_rule(pattern=["codex"], decision="allow")
prefix_rule(pattern=["codex", "mcp"], decision="allow")
prefix_rule(pattern=["codex", "mcp", "list"], decision="allow")
prefix_rule(pattern=["codex", "mcp", "add"], decision="allow")
prefix_rule(pattern=["powershell", "-Command", "if ($env:CONTEXT7_API_KEY) { 'SET' } else { 'MISSING' }"], decision="allow")
prefix_rule(pattern=["node", "-v"], decision="allow")
prefix_rule(pattern=["npm", "-v"], decision="allow")
prefix_rule(pattern=["python", "--version"], decision="allow")
prefix_rule(pattern=["npm", "view"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "npx -y github:erans/lsp-mcp --help"], decision="allow")
prefix_rule(pattern=["npm", "search"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "if (Test-Path docs/plans/adv) { 'exists' } else { 'missing' }"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "Get-ChildItem -Path docs/plans -Force | Select-Object Mode,Name,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "Get-ChildItem -Path docs/plans/adv -Force | Select-Object Mode,Name,LastWriteTime,Length"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "if ($env:GITHUB_PERSONAL_ACCESS_TOKEN -or $env:GITHUB_TOKEN) { 'GITHUB_TOKEN_SET' } else { 'GITHUB_TOKEN_MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "if ($env:CONTEXT7_API_KEY) { 'CONTEXT7_SET' } else { 'CONTEXT7_MISSING' }"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "New-Item -Path docs/plans/adv -ItemType Directory -Force | Out-Null; 'ok'"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "Get-Date -Format yyyy-MM-dd"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "if ($env:GITHUB_PERSONAL_ACCESS_TOKEN) { 'GITHUB_PERSONAL_ACCESS_TOKEN_SET' } elseif ($env:GITHUB_TOKEN) { 'GITHUB_TOKEN_SET_ONLY' } else { 'NO_GITHUB_TOKEN' }"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "Get-ChildItem -Path docs/plans/adv -Force | Select-Object Name,Length,LastWriteTime"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "New-Item -ItemType Directory -Force -Path C:\\Users\\monke\\.codex\\mcp | Out-Null"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "git remote -v"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "git rev-parse --abbrev-ref HEAD"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "git add docs/current_task.md docs/plans/adv/2026-02-15-multi-provider-server-toolcall-and-persona-governance.md docs/plans/adv/2026-02-15-multi-provider-server-toolcall-execution-checklist.md; git status --short"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "git commit -m \"docs(plans): add ADV multi-provider runtime/toolcall plan and phase 80\""], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "git push origin main"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "npx -y pyright-langserver --version"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "codex mcp get lsp-py"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "wsl -l -v"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'echo WSL_OK'"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'echo \"telegram-poller enabled:\"; systemctl --user is-enabled telegram-poller.service || true; echo \"openclaw-gateway enabled:\"; systemctl --user is-enabled openclaw-gateway.service || true'"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "npx -y yaml-language-server --help"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "npx -y --package pyright pyright-langserver --stdio"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "npx -y vscode-json-language-server --help"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "npx -y typescript-language-server --help"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "wsl -d Ubuntu-24.04 -- bash -lc 'systemctl --user disable --now telegram-poller.service openclaw-gateway.service; echo \"[After disable] enabled states\"; systemctl --user is-enabled telegram-poller.service || true; systemctl --user is-enabled openclaw-gateway.service || true; echo; echo \"[After disable] active states\"; systemctl --user is-active telegram-poller.service || true; systemctl --user is-active openclaw-gateway.service || true; echo; echo \"[After disable] process check\"; pgrep -af \"jacks_happy_bots|poller.py run|openclaw|telegram-poller|openclaw-gateway\" || true'"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "npx -y --package vscode-langservers-extracted vscode-json-language-server --stdio"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "npx -y bash-language-server --help"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "powershell -ExecutionPolicy Bypass -File C:\\Users\\monke\\openai-cli\\scripts\\sync.ps1 -DryRun"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "$p='C:\\Users\\monke\\openai-cli\\scripts\\restore.ps1'; $lines=Get-Content $p; for($i=1;$i -le [Math]::Min($lines.Length,340);$i++){ '{0,4}: {1}' -f $i,$lines[$i-1] }"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "$p='C:\\Users\\monke\\openai-cli\\scripts\\sync.ps1'; $lines=Get-Content $p; for($i=1;$i -le [Math]::Min($lines.Length,340);$i++){ '{0,4}: {1}' -f $i,$lines[$i-1] }"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "powershell -ExecutionPolicy Bypass -File C:\\Users\\monke\\openai-cli\\scripts\\restore.ps1 -DryRun"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "$p='C:\\Users\\monke\\openai-cli\\scripts\\restore.ps1'; $t=[System.IO.File]::ReadAllText($p); $enc=New-Object System.Text.UTF8Encoding($true); [System.IO.File]::WriteAllText($p,$t,$enc)"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "$p='C:\\Users\\monke\\openai-cli\\scripts\\sync.ps1'; $t=[System.IO.File]::ReadAllText($p); $enc=New-Object System.Text.UTF8Encoding($true); [System.IO.File]::WriteAllText($p,$t,$enc)"], decision="allow")
prefix_rule(pattern=["C:\\Users\\monke\\AppData\\Local\\Microsoft\\WindowsApps\\pwsh.exe", "-Command", "powershell -ExecutionPolicy Bypass -File C:\\Users\\monke\\openai-cli\\scripts\\sync.ps1 -Message \"Sync canonical baseline (mirror mode)\""], decision="allow")
